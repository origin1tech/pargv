<!DOCTYPE html><html lang="en"><head><title>lib/index</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="lib/index"><meta name="groc-project-path" content="lib/index.js"><meta name="groc-github-url" content="https://github.com/origin1tech/pargv"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/origin1tech/pargv/blob/master/lib/index.js">lib/index.js</a></div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-keyword">var</span> extend = <span class="hljs-built_in">require</span>(<span class="hljs-string">'extend'</span>);
<span class="hljs-keyword">var</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-built_in">module</span>.exports = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
<span class="hljs-pi">
  'use strict'</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Default values.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> defaults = {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Index of primary command.
Typically you want this at 2
because you want to ignore node
path. This will result in the command
being the file called. Set to 0 in .configure
if you wish to parse all arguments.</p></div></div><div class="code"><div class="wrapper">    index: <span class="hljs-number">2</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>When NOT false and not number adjusts index by -1. If number
index is adjusted as:
index += adjustedIndex
adjustIndex: undefined,</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>When not false assumes 1 argument after adjusting for
node path and above index is the primary command.</p></div></div><div class="code"><div class="wrapper">    setCommand: <span class="hljs-literal">undefined</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>When NOT false data types are cast.</p></div></div><div class="code"><div class="wrapper">    castTypes: <span class="hljs-literal">undefined</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Normalize command path. Command may be the
the full path of the filed called it is usually
desirable to strip the path and just leave the
file name. Set this option to false to disable.</p></div></div><div class="code"><div class="wrapper">    normalizeCommand: <span class="hljs-literal">undefined</span>

  };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Parsers attempt to cast string to type by conditions.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> parsers = {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Attempts to parse Date.</p></div></div><div class="code"><div class="wrapper">    date: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) </span>{
      <span class="hljs-keyword">var</span> d = tryParseAs(val, <span class="hljs-built_in">Date</span>),
          n = tryParseAs(val, <span class="hljs-string">'number'</span>);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> n === <span class="hljs-string">'number'</span> &amp;&amp; val.length &lt; <span class="hljs-number">9</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span>(d!==<span class="hljs-string">'Invalid Date'</span> &amp;&amp; !<span class="hljs-built_in">isNaN</span>(d))
        <span class="hljs-keyword">return</span> d;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Attempts to parse Number.</p></div></div><div class="code"><div class="wrapper">    number: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) </span>{
      <span class="hljs-keyword">var</span> n = tryParseAs(val, <span class="hljs-string">'number'</span>);
      <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isNaN</span>(n))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">return</span> n;
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Check if is true or false.</p></div></div><div class="code"><div class="wrapper">    boolean: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) </span>{
      <span class="hljs-keyword">var</span> likeBool = <span class="hljs-regexp">/^(true|false)$/</span>.test(val);
      <span class="hljs-keyword">if</span>(!likeBool)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">return</span> val == <span class="hljs-string">'true'</span>;
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Tests for JSON like string.</p></div></div><div class="code"><div class="wrapper">    json: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) </span>{
      <span class="hljs-keyword">if</span>(<span class="hljs-regexp">/^{/</span>.test(val))
        <span class="hljs-keyword">return</span> tryParseAs(val, <span class="hljs-string">'json'</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Tests for RegExp like string.</p></div></div><div class="code"><div class="wrapper">    regexp: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) </span>{
      <span class="hljs-keyword">if</span>(<span class="hljs-regexp">/^\/.+\/(g|i|m)?([m,i]{1,2})?/</span>.test(val)) {
        val = val.replace(<span class="hljs-regexp">/^\//</span>, <span class="hljs-string">''</span>).replace(<span class="hljs-regexp">/\/$/</span>, <span class="hljs-string">''</span>);
        <span class="hljs-keyword">return</span> tryParseAs(val, <span class="hljs-built_in">RegExp</span>);
      }

      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Tests for key/value type string.
example: &#39;key:value+key2:value2&#39;
delimiter can be: + , * or =</p></div></div><div class="code"><div class="wrapper">    keyValue: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) </span>{
      <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
          match, exp, tmp,
          obj, split;
      obj = {};
      exp = <span class="hljs-regexp">/[a-zA-Z0-9]+:[a-zA-Z0-9]+/g</span>;
      match = val.match(exp);
      <span class="hljs-keyword">if</span>(!match || !match.length)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">while</span>((tmp = exp.exec(val)) !== <span class="hljs-literal">null</span>){
        split = tmp[<span class="hljs-number">0</span>].split(<span class="hljs-string">':'</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Ensure the value is cast.</p></div></div><div class="code"><div class="wrapper">        obj[split[<span class="hljs-number">0</span>]] = self.cast(split[<span class="hljs-number">1</span>]);
      }
      <span class="hljs-keyword">return</span> obj;
    }

  };</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private</span></p>
<p>Method for casting using try catch.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>val must be a String.</strong><br/>(the native JavaScript data type to cast to.)</p>
</li>
<li><p><strong>T must be a Function.</strong><br/>(the native function used to cast value.)</p>
</li>
</ul>
<p><strong>Returns a Boolean or a Type</strong></p>
<p>Example:</p>
<p>tryParseAs(&#39;25&#39;, Number);</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tryParseAs</span>(<span class="hljs-params">val, Type</span>)</span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span>(Type === <span class="hljs-string">'json'</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.parse(val);
      <span class="hljs-keyword">if</span>(Type === <span class="hljs-string">'number'</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>(val);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Type(val);
    } <span class="hljs-keyword">catch</span>(e) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private</span></p>
<p>Tests of argument is a flag type.</p>
<p>Parameters:</p>
<ul>
<li><strong>val must be a *.</strong><br/>(the value to test for flag.)</li>
</ul>
<p><strong>Returns a Boolean</strong></p>
<p>Example:</p>
<p>isFlag(&#39;-m&#39;);</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isFlag</span>(<span class="hljs-params">val</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-regexp">/^(-|--)[a-zA-Z0-9]+/</span>.test(val);
  }</div></div></div><div class="segment"><div class="comments doc-section doc-section-private"><div class="wrapper"><p><span class='doc-section-header'>Private</span></p>
<p>Strips dashes from string for flags.</p>
<p>Parameters:</p>
<ul>
<li><strong>val must be a String.</strong><br/>(the string flag to be stripped.)</li>
</ul>
<p><strong>Returns a String</strong></p>
<p>Example:</p>
<p>stripFlag(&#39;--save&#39;);</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stripFlag</span>(<span class="hljs-params">val</span>) </span>{
    <span class="hljs-keyword">return</span> val.replace(<span class="hljs-regexp">/^(-|--)/</span>, <span class="hljs-string">''</span>);
  }</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'>Method injectDebug</span></p>
<p>When debugging process.argv will
not contain the debug flag so we&#39;ll
detect it and inject in correct order.
NOTE: method is called before any index
adjustments are on arguments array.</p>
<p>Parameters:</p>
<ul>
<li><strong>arr must be an Array.</strong></li>
</ul>
<p><strong>Returns an Array</strong></p></div></div><div class="code"><div class="wrapper">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">injectDebug</span>(<span class="hljs-params">arr</span>) </span>{
    <span class="hljs-keyword">var</span> _arr = [];</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Get first arg.</p></div></div><div class="code"><div class="wrapper">    _arr.push(arr.shift());</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Inject debug. This could be
--debug-brk but we just use
--debug.</p></div></div><div class="code"><div class="wrapper">    _arr.push(<span class="hljs-string">'--debug'</span>);
    _arr.push(<span class="hljs-literal">true</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Concat the arrays and return.</p></div></div><div class="code"><div class="wrapper">    _arr = _arr.concat(arr);
    <span class="hljs-keyword">return</span> _arr;
  }</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p><span class='doc-section-header'>Constructor class</span></p>
<p>Pargv Class</p>
<p><strong>Returns a Pargv</strong></p></div></div><div class="code"><div class="wrapper">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Pargv</span>(<span class="hljs-params"></span>) </span>{</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Boolean true if manually supplied array.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">this</span>._static = <span class="hljs-literal">false</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Array containing original source.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">this</span>._source = [];</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>The parsed result.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">this</span>._parsed = {};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Custom parsers</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">this</span>._customParsers = {};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Object containing</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">this</span>._parsers = extend({}, parsers);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Object of configuration options.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">this</span>._options = defaults;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Return Pargv instance.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;

  }</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>Configures Pargv.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>index is optional and can be a Number or an Object.</strong><br/>(index of command or object of options.)</p>
</li>
<li><p><strong>options is optional and must be an Object.</strong><br/>([description])</p>
</li>
</ul>
<p><strong>Returns a Pargv</strong><br/>([description])</p>
<p>Example:</p>
<p>pargv.configure(3, {// your options });</p></div></div><div class="code"><div class="wrapper">  Pargv.prototype.configure = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configure</span>(<span class="hljs-params">index, options</span>) </span>{</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Allow options as first param.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span>(index !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-regexp">/^{/</span>.test(<span class="hljs-built_in">JSON</span>.stringify(index))){
      options = index;
      index = <span class="hljs-literal">undefined</span>;
    }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Merge configuration options.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">this</span>._options = extend({}, <span class="hljs-keyword">this</span>._options, options);
    <span class="hljs-keyword">this</span>._options.index = index !== <span class="hljs-literal">undefined</span> ? index : <span class="hljs-keyword">this</span>._options.index;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Return Pargv instance.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;

  }</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>Adds new parser to configuration.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>name can be a String or an Object.</strong><br/>(- the name of the parser to add or object of parsers.)</p>
</li>
<li><p><strong>fn must be a Function.</strong><br/>(- the function used for parsing.)</p>
</li>
</ul>
<p><strong>Returns a Pargv</strong></p>
<p>Example:</p>
<p>pargv.addParser(&#39;email&#39;, function (val) {
    // return truthy value if success
    // return false if failed to continue inspections.
});</p></div></div><div class="code"><div class="wrapper">  Pargv.prototype.addParser = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addParser</span>(<span class="hljs-params">name, fn, modify</span>) </span>{</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If is object extend.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^{/</span>.test(<span class="hljs-built_in">JSON</span>.stringify(name))) {
      <span class="hljs-keyword">this</span>._customParsers = extend({}, <span class="hljs-keyword">this</span>._customParsers, name);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If parser exists and not modifying throw error.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._customParsers[name] &amp;&amp; !modify)
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Failed to add parser '</span> + name + <span class="hljs-string">' the parser already exists. Did you mean to use pargv.modifyParser?'</span>);

    <span class="hljs-keyword">this</span>._customParsers[name] = fn;

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;

  }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>DEPRECATED USE addParser.</p></div></div><div class="code"><div class="wrapper">  Pargv.prototype.modifyParser = Pargv.prototype.addParser;</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>Inspects and casts a string value to detected type.</p>
<p>Parameters:</p>
<ul>
<li><strong>val must be a String.</strong><br/>(the value to be cast.)</li>
</ul>
<p><strong>Returns a *</strong></p>
<p>Example:</p>
<p>pargv.cast(&#39;true&#39;);</p></div></div><div class="code"><div class="wrapper">  Pargv.prototype.cast = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cast</span>(<span class="hljs-params">val</span>) </span>{</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Do not process if casting is disabled.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._options.castTypes === <span class="hljs-literal">false</span>)
      <span class="hljs-keyword">return</span> val;

    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
        keys = <span class="hljs-built_in">Object</span>.keys(<span class="hljs-keyword">this</span>._parsers),
        custKeys = <span class="hljs-built_in">Object</span>.keys(<span class="hljs-keyword">this</span>._customParsers),
        parsed,
        key,
        custKey,
        result;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Run if custom parsers.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span> (custKeys.length) {
      <span class="hljs-keyword">while</span>(!result &amp;&amp; custKeys.length) {
        custKey = custKeys.shift();
        result = self._customParsers[custKey].call(self, val);
      }
    }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If known type immediately return.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'number'</span> ||
       <span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'boolean'</span> ||
       <span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'date'</span> ||
       (val <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RegExp</span>) ||
       (<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'object'</span> &amp;&amp; val !== <span class="hljs-literal">null</span>)) {
         <span class="hljs-keyword">return</span> val;
       }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If a string trim.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'string'</span>)
      val = val.trim();</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Iterate until some returns truthy value.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">while</span>(!result &amp;&amp; keys.length){
      key = keys.shift();
      result = self._parsers[key].call(self, val);
    }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If result is still false set to original value.</p></div></div><div class="code"><div class="wrapper">    result = result || val;

    <span class="hljs-keyword">return</span> result;

  };</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>Parse the arguments.</p>
<p>Parameters:</p>
<ul>
<li><strong>args is optional and can be a String or an Object.</strong><br/>(a string or array of arguments to parse.)</li>
</ul>
<p><strong>Returns an Objerct</strong></p>
<p>Example:</p>
<p>pargv.parse([&#39;start&#39;, &#39;-p&#39;, 3000 ]);</p></div></div><div class="code"><div class="wrapper">  Pargv.prototype.parse = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parse</span>(<span class="hljs-params">args</span>) </span>{

    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
        pargs = { cmds: []},
        indexes = [],
        options, idx,
        warn, next, key,
        tmpFlag, tmpCmd, prev, isDebug;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>adjustVal, adjustIsNum;</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Test if we are debugging.</p></div></div><div class="code"><div class="wrapper">    isDebug = <span class="hljs-keyword">typeof</span> v8debug !== <span class="hljs-string">'undefined'</span>;

    options = <span class="hljs-keyword">this</span>._options;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Check if adjust is specified int.
adjustIsNum = typeof options.adjustIndex === &#39;number&#39;;</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Set default value of -1 if undefined.
Other wise is false and disabled.
adjustVal = adjustIsNum ?
  options.adjustIndex :
  options.adjustIndex !== false ? -1 : false;</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>subtract one so we slice
at the correct index.</p></div></div><div class="code"><div class="wrapper">    idx = options.index += -<span class="hljs-number">1</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Ensure index is 0 or greater.</p></div></div><div class="code"><div class="wrapper">    idx = idx &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : idx;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If args are statically
defined set flag to true.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span>(args) {
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> args === <span class="hljs-string">'string'</span>)
        args = args.replace(<span class="hljs-regexp">/(\s,|,\s)/</span>, <span class="hljs-string">','</span>).trim().split(<span class="hljs-string">','</span>);
      <span class="hljs-keyword">this</span>._static = <span class="hljs-literal">true</span>;
    }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Ensure args.</p></div></div><div class="code"><div class="wrapper">    args = args || process.argv;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Normalize args if debugging.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span> (isDebug)
      args = injectDebug(args);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Splice to defined index.</p></div></div><div class="code"><div class="wrapper">    args = args.splice(idx);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Update source with original args after splice.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">this</span>._source = args.slice(<span class="hljs-number">0</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If setCommand first arg is command.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span>(!<span class="hljs-regexp">/^-/</span>.test(args[<span class="hljs-number">0</span>]) &amp;&amp; options.setCommand !== <span class="hljs-literal">false</span>) {
      pargs.cmd = args.shift();
      <span class="hljs-keyword">if</span> (options.normalizeCommand !== <span class="hljs-literal">false</span>)
        pargs.cmd = pargs.cmd.split(path.sep).pop();
    }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Iterate the args.</p></div></div><div class="code"><div class="wrapper">    args.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">k,i</span>) </span>{</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Check if is flag.</p></div></div><div class="code"><div class="wrapper">       <span class="hljs-keyword">if</span>(isFlag(k)) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>flags with single &quot;-&quot; are just boolean
flags, flags with &quot;--&quot; require a value.</p></div></div><div class="code"><div class="wrapper">         <span class="hljs-keyword">var</span> isFlagBool = <span class="hljs-regexp">/^-[a-zA-Z0-9]/</span>.test(k);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Get next argument.</p></div></div><div class="code"><div class="wrapper">         next = args[i+<span class="hljs-number">1</span>];</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Replace flag prefix.</p></div></div><div class="code"><div class="wrapper">         key = k.replace(<span class="hljs-regexp">/^-{1,2}/g</span>, <span class="hljs-string">''</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Index has been parsed.</p></div></div><div class="code"><div class="wrapper">         indexes.push(i);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If next argument not flag then parse cast value
as this flag requires a value.</p></div></div><div class="code"><div class="wrapper">         <span class="hljs-keyword">if</span>(next &amp;&amp; !isFlag(next) &amp;&amp; !isFlagBool) {
            tmpFlag = self.cast(next) || next;
            pargs[key] = tmpFlag;
            indexes.push(i+<span class="hljs-number">1</span>);
         }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Otherwise is simply boolean type flag.</p></div></div><div class="code"><div class="wrapper">         <span class="hljs-keyword">else</span> {
            pargs[key] = <span class="hljs-literal">true</span>;
         }

       }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Otherwise is cmd or sub command.</p></div></div><div class="code"><div class="wrapper">       <span class="hljs-keyword">else</span> {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Get previous argument.</p></div></div><div class="code"><div class="wrapper">         prev = args[i-<span class="hljs-number">1</span>];</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If previous argument and not a flag parse &amp; cast.</p></div></div><div class="code"><div class="wrapper">         <span class="hljs-keyword">if</span>(prev &amp;&amp; !isFlag(prev)){</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Cast and push the parsed argument.</p></div></div><div class="code"><div class="wrapper">           tmpCmd = self.cast(k) || k;
           pargs.cmds.push(tmpCmd);
           indexes.push(i);

         }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Otherwise is a cmd.</p></div></div><div class="code"><div class="wrapper">         <span class="hljs-keyword">else</span> {
           <span class="hljs-keyword">if</span>(indexes.indexOf(i) === -<span class="hljs-number">1</span>){
              tmpCmd = self.cast(k);
              pargs.cmds.push(tmpCmd);
           }
         }

       }

    });</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Add original source to object.</p></div></div><div class="code"><div class="wrapper">    pargs.source = <span class="hljs-keyword">this</span>._source;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Save the parsed result.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">this</span>._parsed = pargs;

    <span class="hljs-keyword">return</span> pargs;

  }</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>Returns only flags from parsed object.</p>
<p>Parameters:</p>
<ul>
<li><strong>parsed is optional and must be an Object.</strong><br/>(optional parsed object otherwise use this._parsed.)</li>
</ul>
<p><strong>Returns an Object</strong></p>
<p>Example:</p>
<p>pargv.getFlags();</p></div></div><div class="code"><div class="wrapper">  Pargv.prototype.getFlags = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFalgs</span>(<span class="hljs-params">parsed</span>) </span>{
    parsed = parsed || <span class="hljs-keyword">this</span>._parsed;
    parsed = extend({}, parsed);
    <span class="hljs-keyword">delete</span> parsed.cmd;
    <span class="hljs-keyword">delete</span> parsed.cmds;
    <span class="hljs-keyword">delete</span> parsed.source;
    <span class="hljs-keyword">return</span> parsed;
  };</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>Check if has command.</p>
<p>Parameters:</p>
<ul>
<li><strong>val must be a *.</strong></li>
</ul>
<p><strong>Returns a Boolean</strong></p></div></div><div class="code"><div class="wrapper">  Pargv.prototype.hasCmd = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasCmd</span>(<span class="hljs-params">val, parsed</span>) </span>{

    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
        args = [].slice.call(<span class="hljs-built_in">arguments</span>);

    parsed = parsed || <span class="hljs-keyword">this</span>._parsed;

    <span class="hljs-keyword">if</span> (!args.length)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>check if first arg is array.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span> (args[<span class="hljs-number">0</span>] <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>)
      args = args[<span class="hljs-number">0</span>];

    <span class="hljs-keyword">if</span> (args.length === <span class="hljs-number">1</span>)
      <span class="hljs-keyword">return</span> parsed.cmds.indexOf(val) &gt; <span class="hljs-number">0</span>;

    <span class="hljs-keyword">var</span> found;
    args.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arg</span>) </span>{
      <span class="hljs-keyword">if</span> (found)
        <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">if</span> (parsed.cmds.indexOf(val) &gt; <span class="hljs-number">0</span>)
        found = <span class="hljs-literal">true</span>;
    });

    <span class="hljs-keyword">return</span> found;

  }</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>Using parsed object will get flags only then
convert to an array of elements in array.
It is important to NOT include prefixes such as
&quot;-&quot; or &quot;--&quot; in your defaults object. By default
wrapQuotes is on by default. Often when converting
flags to an array you need quotes wrapped for passing
to an .exec or .spawn for example.</p>
<p>Parameters:</p>
<ul>
<li><p><strong>defaults is optional and can be an Object or a Boolean.</strong><br/>(object containing defaults for matched flags.)</p>
</li>
<li><p><strong>wrapQuotes is optional and must be a Boolean.</strong><br/>(when NOT false strings are wraped w/ quotes.)</p>
</li>
</ul>
<p><strong>Returns an Array</strong></p>
<p>Example:</p>
<p>pargv.flagsToArray();</p></div></div><div class="code"><div class="wrapper">  Pargv.prototype.flagsToArray = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flagsToArray</span>(<span class="hljs-params">defaults, wrapQuotes</span>) </span>{

      <span class="hljs-keyword">var</span> flags = <span class="hljs-keyword">this</span>.getFlags(),
          arr = [],
          flag,
          keys;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Enable wrapQuotes as first argument.</p></div></div><div class="code"><div class="wrapper">      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> defaults === <span class="hljs-string">'boolean'</span>){
        wrapQuotes = defaults;
        defaults = <span class="hljs-literal">undefined</span>;
      }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Simple function to return</p></div></div><div class="code"><div class="wrapper">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFlagPrefix</span>(<span class="hljs-params">f</span>)</span>{
        <span class="hljs-keyword">if</span>(f.length &gt; <span class="hljs-number">1</span>)
          <span class="hljs-keyword">return</span> <span class="hljs-string">'--'</span> + f;
        <span class="hljs-keyword">return</span> <span class="hljs-string">'-'</span> + f;
      }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Ensure value defaults object.</p></div></div><div class="code"><div class="wrapper">      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> defaults !== <span class="hljs-string">'object'</span>)
        defaults = {};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Useful when you want to have a flag default to a value.</p></div></div><div class="code"><div class="wrapper">      flags = extend({}, defaults, flags);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Get an array of flag keys.</p></div></div><div class="code"><div class="wrapper">      keys = <span class="hljs-built_in">Object</span>.keys(flags);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Iterate keys and build array.</p></div></div><div class="code"><div class="wrapper">      keys.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">k</span>) </span>{

        flag = flags[k];</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Get key prefix.</p></div></div><div class="code"><div class="wrapper">        k = getFlagPrefix(k);

        arr.push(k);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If flag === true push flag only.</p></div></div><div class="code"><div class="wrapper">        <span class="hljs-keyword">if</span>(flag !== <span class="hljs-literal">true</span>){

          <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> flag === <span class="hljs-string">'string'</span> &amp;&amp; wrapQuotes !== <span class="hljs-literal">false</span>){
            flag = flag.replace(<span class="hljs-regexp">/^('|")/</span>, <span class="hljs-string">''</span>).replace(<span class="hljs-regexp">/('|")$/</span>, <span class="hljs-string">''</span>);
            flag = <span class="hljs-string">'"'</span> + flag + <span class="hljs-string">'"'</span>;
          }

          arr.push(flag);

        }

      });

      <span class="hljs-keyword">return</span> arr;
  };</div></div></div><div class="segment"><div class="comments doc-section"><div class="wrapper"><p>Resets configuration to default.</p>
<p><strong>Returns a Pargv</strong></p></div></div><div class="code"><div class="wrapper">  Pargv.prototype.reset = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reset</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>._static = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>._source = [];
    <span class="hljs-keyword">this</span>._options = extend({}, defaults);
    <span class="hljs-keyword">this</span>._parsed = {};
    <span class="hljs-keyword">this</span>._customParsers = {};
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Create &amp; return new Pargv instance.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Pargv();

})();</div></div></div></div></body></html>